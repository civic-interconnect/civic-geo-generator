{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Civic Geo Generator","text":"<p>Lightweight CLI and library to build web-optimized GeoJSON for election precincts (and similar layers). Outputs three artifacts per run:</p> <ul> <li>full GeoJSON (QA and reproducibility)</li> <li>web GeoJSON (served to apps)</li> <li>TopoJSON (optional, for smaller delivery)</li> </ul> <p>It also writes per-version <code>metadata.json</code>, and a state <code>index.json</code> that points to the latest layer.</p>"},{"location":"#quick-start","title":"Quick start","text":"<pre><code># install deps\nuv sync --extra dev --extra docs --upgrade\n\n# build, validate, index for a version\nuv run civic-gen build    --version 2025-04\nuv run civic-gen validate --version 2025-04\nuv run civic-gen index\n\n# orchestrated runs based on yaml file\nuv run civic-gen run -f inputs.yaml\n\n# or for just MN precincts\nuv run civic-gen run MN precincts\n</code></pre>"},{"location":"#conventions","title":"Conventions","text":"<ul> <li>Batch inputs live in <code>inputs.yaml</code>.</li> <li>Config files live under <code>data-config/</code> (e.g., <code>us/mn/precincts.yaml</code>).</li> <li>Data input files should be placed in the <code>data-in</code> folder, organized by state and layer as described in your YAML configs (e.g., <code>data-config/us/mn/precincts.yaml</code>).</li> <li>Outputs are written under <code>data-out/us/&lt;state-name&gt;/&lt;view&gt;/&lt;version&gt;/</code>.</li> </ul>"},{"location":"#links","title":"Links","text":"<ul> <li>Source: https://github.com/civic-interconnect/civic-geo-generator</li> <li>Issues: https://github.com/civic-interconnect/civic-geo-generator/issues</li> </ul>"},{"location":"api/","title":"API Reference","text":"<p>Auto-generated code documentation.</p> <p>options: show_submodules: true show_source: true</p>"},{"location":"api/#civic_geo_generator","title":"civic_geo_generator","text":""},{"location":"checklist-new-state/","title":"New-State Bring-Up Checklist","text":""},{"location":"checklist-new-state/#1-create-config","title":"1) Create config","text":"<ul> <li>Copy a template and save as: <code>data-config/us/{state2lower}/{view}.yaml</code></li> <li>Fill in:</li> <li>build.version (YYYY-MM)</li> <li>build.input_path (relative to <code>data-in/</code>)</li> <li>fields_rename, fields_keep, add_fields</li> <li>write_topojson, simplify_pct</li> <li>required_columns (optional override)</li> <li>unique_id_column (default: unit_id)</li> </ul>"},{"location":"checklist-new-state/#2-stage-inputs","title":"2) Stage inputs","text":"<ul> <li>Put raw data under <code>data-in/...</code> per your config.</li> <li>Commit nothing in <code>data-in</code> (it is local-only).</li> </ul>"},{"location":"checklist-new-state/#3-dry-run","title":"3) Dry run","text":"<pre><code># single build\ncivic-gen build -v 2025-04\n\n# validate\ncivic-gen validate -v 2025-04\n\n# index (flat + state)\ncivic-gen index\n</code></pre> <p>Or batch:</p> <pre><code># inputs.yaml controls runs\ncivic-gen run -f inputs.yaml\n</code></pre>"},{"location":"checklist-new-state/#4-qa-spot-checks","title":"4) QA spot checks","text":"<ul> <li>Open <code>data-out/us/{state_slug}/{view}/{version}/metadata.json</code></li> <li>Confirm:</li> <li>CRS EPSG:4326, geometry type Polygon/MultiPolygon</li> <li>features count reasonable</li> <li>bbox sane</li> <li>id_field/name_field present and correct</li> <li><code>source_fields</code> maps from canonical to original columns</li> </ul>"},{"location":"checklist-new-state/#5-app-smoke-test","title":"5) App smoke test","text":"<ul> <li>Load <code>web.geojson</code> or <code>web.topojson</code> into your map (local Insights) and confirm labels and filters.</li> </ul>"},{"location":"checklist-new-state/#6-prepare-for-publish-optional","title":"6) Prepare for publish (optional)","text":"<ul> <li>Verify <code>data-out/us/{state_slug}/{view}/{version}/</code> contains:</li> <li>full.geojson</li> <li>web.geojson</li> <li>web.topojson (if enabled)</li> <li>metadata.json</li> <li>Ensure <code>data-out/us/{state_slug}/index.json</code> points <code>latest</code> to your version.</li> </ul>"},{"location":"checklist-new-state/#7-publish-manual","title":"7) Publish (manual)","text":"<ul> <li>Publishing must be idempotent and additive (no history deletion).</li> <li>For now, manually add upload or push to data repo.</li> </ul>"},{"location":"data-contract/","title":"Civic Geo Generator: Data Contract","text":""},{"location":"data-contract/#scope","title":"Scope","text":"<p>This contract defines the on-disk outputs written by civic-geo-generator for any state/view (e.g., precincts, school_districts). It standardizes file names, metadata, geometry rules, and per-release versioning so downstream apps (e.g., Insights) can consume data without per-state code.</p>"},{"location":"data-contract/#canonical-attributes-properties-on-each-feature","title":"Canonical attributes (properties on each feature)","text":"<ul> <li>unit_id: canonical identifier as a string (stable across releases when possible).</li> <li>unit_name: display name.</li> <li>unit_type: enum describing feature class (e.g., \"precinct\", \"ward\", \"school_district\").</li> <li>state_code: 2-letter USPS (e.g., \"MN\").</li> <li>state_fips: 2-digit string (e.g., \"27\").</li> <li>unit_parent_id (optional): stable parent id (e.g., county FIPS or name).</li> <li>source_* (optional): original authority fields retained for traceability.</li> </ul> <p>Rules:</p> <ul> <li>IDs are strings; trim whitespace; lowercase column names; preserve UTF-8 in values.</li> <li>Null policy: use explicit null (not empty strings) where data is missing.</li> </ul>"},{"location":"data-contract/#geometry-and-spatial-rules","title":"Geometry and spatial rules","text":"<ul> <li>CRS: EPSG:4326 only.</li> <li>Validity: repair invalid geometries (make_valid then buffer(0)). Drop empties.</li> <li>Types: Polygon or MultiPolygon only.</li> <li>Precision: coordinates rounded to 6\u20137 decimals.</li> <li>Optional label_point: precomputed centroid for labeling (lon, lat).</li> </ul>"},{"location":"data-contract/#file-naming-and-tiers","title":"File naming and tiers","text":"<p>Within: <code>data-out/us/{state_slug}/{view}/{version}/</code></p> <ul> <li>full.geojson (canonical, unsimplified)</li> <li>web.geojson (same geometry as full or lightly simplified)</li> <li>web.topojson (simplified TopoJSON for web maps)</li> <li>metadata.json (dataset-level info and app contract)</li> </ul> <p>Example (MN precincts, Apr 2025):</p> <pre><code>data-out/us/mn/precincts/2025-04/\n  full.geojson\n  web.geojson\n  web.topojson\n  metadata.json\n</code></pre>"},{"location":"data-contract/#versioning","title":"Versioning","text":"<ul> <li>Each build writes to a new <code>version</code> folder (e.g., YYYY-MM). No overwrites.</li> <li>\u201cLatest\u201d pointers live in a state index (see below).</li> </ul>"},{"location":"data-contract/#metadata-contract-metadatajson","title":"Metadata contract (metadata.json)","text":"<p>Required fields (see schema for full details):</p> <ul> <li>id: stable dataset id, e.g., \"us/mn/precincts\".</li> <li>title: human-friendly title.</li> <li>unit_type: canonical enum (e.g., \"precinct\").</li> <li>id_field: name of the canonical id column (usually \"unit_id\").</li> <li>name_field: name of the canonical display column (usually \"unit_name\").</li> <li>snapshot_version: build version string (e.g., \"2025-04\").</li> <li>generated_at: ISO 8601 UTC timestamp.</li> <li>spatial: { crs: \"EPSG:4326\", geometry_type: \"Polygon\" | \"MultiPolygon\" }.</li> <li>stats: { features, bbox } where bbox is [minx, miny, maxx, maxy].</li> <li>paths: { full_geojson, web_geojson, web_topojson? }.</li> <li>source_name, source_url, license (and optional license_url).</li> <li>source_fields: mapping from canonical fields to an array of original source fields.</li> <li>web: { topojson_simplify_pct? }.</li> </ul> <p>Optional:</p> <ul> <li>label_point_field: name of field containing [lon, lat].</li> <li>checksums: { filename: sha256 } map.</li> </ul>"},{"location":"data-contract/#indices","title":"Indices","text":"<ul> <li>Flat index: <code>data-out/index.json</code></li> <li>Array of files with path (relative), bbox, features, version, state_code, view.</li> <li>State index: <code>data-out/us/{state_slug}/index.json</code></li> <li>Pointers to the latest metadata per view, e.g.:     <pre><code>{\n  \"layers\": [\n    { \"id\": \"us/mn/precincts\", \"latest\": \"precincts/2025-04/metadata.json\" }\n  ]\n}\n</code></pre></li> </ul>"},{"location":"data-contract/#validation-gates","title":"Validation gates","text":"<ul> <li>Files exist per tier.</li> <li>GeoJSON readable; not empty; geometries valid; CRS is EPSG:4326.</li> <li>Required columns present (<code>unit_id</code>, <code>unit_name</code>, <code>unit_type</code>, <code>state_code</code>).</li> <li>Uniqueness check on <code>unit_id</code> (configurable).</li> <li>BBox sanity (optional) versus state bounds.</li> </ul>"},{"location":"data-contract/#publishing-manually-upload-or-push-to-civic-data-github-repo","title":"Publishing (manually upload or push to civic-data-* GitHub repo)","text":"<ul> <li>Build/validate/index locally first.</li> <li>Never delete history; new versions are additive.</li> </ul>"}]}